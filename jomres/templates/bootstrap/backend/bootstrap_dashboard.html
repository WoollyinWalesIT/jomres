<patTemplate:tmpl name="pageoutput" unusedvars="strip">

<script type="text/javascript">
jomresJquery(document).ready(function () {
    "use strict";
	var options = {
		events_source: '{AJAXURL}',
		view: 'month',
		first_day: '{FIRST_DAY_OF_WEEK}',
		tmpl_path: '{TMPL_PATH}',
		tmpl_cache: false,
		day: 'now',
		language: '{LANG}',
		/*holidays: {
			'08-03': 'International Women\'s Day',
			'25-12': 'Christmas\'s',
			'01-05': "International labor day"
		},*/

		{ROOMS_DROPDOWN_JS}
		
		onAfterEventsLoad: function(events) {
			if(!events) {
				return;
			}
			var list = jomresJquery('#eventlist');
			list.html('');

			jomresJquery.each(events, function(key, val) {
				jomresJquery(document.createElement('li'))
					.html('<a href="' + val.url + '">' + val.title + '</a>')
					.appendTo(list);
			});
		},
		onAfterViewLoad: function(view) {
			jomresJquery('.jomres-dashboard h2').text(this.getTitle());
			jomresJquery('.jomres-dashboard h4').text('{HBOOKINGS_LIST} ' + this.getTitle());
			jomresJquery('.btn-group button').removeClass('active');
			jomresJquery('button[data-calendar-view="' + view + '"]').addClass('active');
		},
		classes: {
			months: {
				general: 'label'
			}
		}
	};

	var	 jomres_dashboard = jomresJquery('#calendar').calendar(options);

	jomresJquery('.btn-group button[data-calendar-nav]').each(function() {
		var $this = jomresJquery(this);
		$this.click(function() {
			jomres_dashboard.navigate($this.data('calendar-nav'));
		});
	});

	jomresJquery('.btn-group button[data-calendar-view]').each(function() {
		var $this = jomresJquery(this);
		$this.click(function() {
			jomres_dashboard.view($this.data('calendar-view'));
		});
	});

    jomresJquery('#room_uids').change(function(){
        var value = jomresJquery(this).val();
        value = value.length ? parseInt(value) : null;
        jomres_dashboard.setOptions({events_source: '{AJAXURL}' + '&room_uid=' + value});
        jomres_dashboard.view();
    });

    /*jomresJquery('#language').change(function(){
        jomres_dashboard.setLanguage(jomresJquery(this).val());
        jomres_dashboard.view();
    });*/
});
</script>


<div class="pull-right form-inline">
	<div class="btn-group">
		<button class="btn btn-primary" data-calendar-nav="prev"><< {PREV}</button>
		<button class="btn" data-calendar-nav="today">{TODAY}</button>
		<button class="btn btn-primary" data-calendar-nav="next">{NEXT} >></button>
	</div>
	<div class="btn-group">
		<button class="btn btn-warning" data-calendar-view="year">{YEAR}</button>
		<button class="btn btn-warning active" data-calendar-view="month">{MONTH}</button>
		<button class="btn btn-warning" data-calendar-view="week">{WEEK}</button>
		<button class="btn btn-warning" data-calendar-view="day">{DAY}</button>
	</div>
</div>
<div class="page-header jomres-dashboard">
	<h2>Dashboard</h2>
</div>
<div class="clearfix"></div>
<div class="row-fluid">
	<div class="span9">
		<div id="calendar"></div>
		<div>&nbsp;</div>
		<h5>{HLEGEND}</h5>
		<span class="label label-warning">{HPROVISIONALBOOKING}</span>
		<span class="label label-important">{HCONFIRMEDBOOKING}</span>
		<span class="label label-inverse">{HBLACKBOOKING}</span>
		<span class="label label-success">{HCURRENTRESIDENT}</span>
		<span class="label label-info">{HBOOKEDOUT}</span>
	</div>
	<div class="span3">
		<div class="row-fluid">
			<patTemplate:tmpl name="roomsoutput" unusedvars="strip" type="simpleCondition" requiredVars="rooms_dropdown">
			<h4 class="page-header">{HROOMS_DROPDOWN}</h4>
			{ROOMS_DROPDOWN}
			</patTemplate:tmpl>
			<div class="page-header jomres-dashboard"><h4>{HBOOKINGS_LIST}</h4></div>
			<ul id="eventlist" class="nav nav-list"></ul>
		</div>
	</div>
</div>
<div class="clearfix"></div>
</patTemplate:tmpl>