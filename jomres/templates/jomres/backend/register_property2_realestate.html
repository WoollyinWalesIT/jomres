<patTemplate:tmpl name="pageoutput">
<style>
.REmail {border:solid 1px {INPUTBOXERRORBORDER};background-color: {INPUTBOXERRORBACKGROUND};}
td.required {color:red;}
--></style>
<script src="http://maps.google.com/maps?file=api&v=2.x&key={APIKEY}&hl=en" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
function validatePropertyRegistration()
	{
	valid = true;
	missingfields = "";
	document.regForm.property_name.className="inputbox";
	document.regForm.property_street.className="inputbox";
	document.regForm.property_town.className="inputbox";
	document.regForm.property_postcode.className="inputbox";
	document.regForm.property_tel.className="inputbox";
	document.regForm.property_email.className="inputbox";
	document.regForm.property_description.className="inputbox";
	if ( document.regForm.property_name.value == "" )
		{
		document.regForm.property_name.className="REmail";
		valid = false;
		}
	if ( document.regForm.property_street.value == "" )
		{
		document.regForm.property_street.className="REmail";
		valid = false;
		}
	if ( document.regForm.property_town.value == "" )
		{
		document.regForm.property_town.className="REmail";
		valid = false;
		}
	if ( document.regForm.property_street.value == "" )
		{
		document.regForm.property_street.className="REmail";
		valid = false;
		}
	if ( document.regForm.property_postcode.value == "" )
		{
		document.regForm.property_postcode.className="REmail";
		valid = false;
		}
	if ( document.regForm.property_tel.value == "" )
		{
		document.regForm.property_tel.className="REmail";
		valid = false;
		}
	if ( document.regForm.property_description.value == "" )
		{
		document.regForm.property_description.className="REmail";
		valid = false;
		}
	
	var emailID=document.regForm.property_email
	if ((emailID.value==null)||(emailID.value=="")){
		document.regForm.property_email.className="REmail";
		emailID.focus()
		valid = false;
		}
	else
		{
		if (echeck(emailID.value)==false){
			document.regForm.property_email.className="REmail";
			emailID.value=""
			emailID.focus()
			 valid = false;
			 }
		}
	if (valid)
		{
		document.regForm.action = "{JOMRES_SITEPAGE_URL}&task=saveRegisterProp"
		document.regForm.submit();
		}
	else
		{
		 alert ( "{JOMRES_REGISTRATION_INSTRUCTIONS_STEP2_2_BUTTON}" );
		}
	}
	/**
	 * DHTML email validation script. Courtesy of SmartWebby.com (http://www.smartwebby.com/dhtml/)
	 */
function echeck(str) {
	var at="@"
	var dot="."
	var lat=str.indexOf(at)
	var lstr=str.length
	var ldot=str.indexOf(dot)
	if (str.indexOf(at)==-1){
		alert("Invalid E-mail ID")
		 return false
		}
	if (str.indexOf(at)==-1 || str.indexOf(at)==0 || str.indexOf(at)==lstr){
		 alert("Invalid E-mail ID");
		 return false;
		}
	if (str.indexOf(dot)==-1 || str.indexOf(dot)==0 || str.indexOf(dot)==lstr){
		alert("Invalid E-mail ID")
		return false
		}
	if (str.indexOf(at,(lat+1))!=-1){
		alert("Invalid E-mail ID")
		return false
		}
	if (str.substring(lat-1,lat)==dot || str.substring(lat+1,lat+2)==dot){
		alert("Invalid E-mail ID")
		return false
		}
	if (str.indexOf(dot,(lat+2))==-1){
		alert("Invalid E-mail ID")
		return false
		}
	if (str.indexOf(" ")!=-1){
		alert("Invalid E-mail ID")
		return false
		}
	return true
	}
	

jomresJquery(document).ready(function () {
    var select = '#mySelect';
    jomresJquery(select).attr('selectedIndex', '-1');
    jomresJquery(select).change(function () {
        jomresJquery(select + ' option').each(function () {
            jomresJquery('#' + this.value).hide();
        });
        jomresJquery(select + ' option:selected').each(function () {
            jomresJquery('#' + this.value).show();
        });
    }).change();
});


<!-- Clickable locations adapted from http://universimmedia.pagesperso-orange.fr/geo/loc.htm -->
function load() {
	if (GBrowserIsCompatible()) {
		var map = new GMap2(document.getElementById("map"));
		map.setUIToDefault();
		map.setMapType(G_HYBRID_MAP);
		map.enableScrollWheelZoom();
		var center = new GLatLng(48.858334,2.294254);
		map.setCenter(center, 15);
		geocoder = new GClientGeocoder();
		var marker = new GMarker(center, {draggable: true});  
		map.addOverlay(marker);
		document.getElementById("lat").innerHTML = center.lat().toFixed(5);
		document.getElementById("lng").innerHTML = center.lng().toFixed(5);

		GEvent.addListener(marker, "dragend", function() {
			var point = marker.getPoint();
			map.panTo(point);
			jomresJquery('#lat').val(point.lat().toFixed(5));
			jomresJquery('#lng').val(point.lng().toFixed(5));
			});

		GEvent.addListener(map, "moveend", function() {
			map.clearOverlays();
			var center = map.getCenter();
			var marker = new GMarker(center, {draggable: true});
			map.addOverlay(marker);
			jomresJquery('#lat').val( center.lat().toFixed(5) );
			jomresJquery('#lng').val( center.lng().toFixed(5) );

			GEvent.addListener(marker, "dragend", function() {
				var point =marker.getPoint();
				map.panTo(point);
				jomresJquery('#lat').val(point.lat().toFixed(5));
				jomresJquery('#lng').val( point.lng().toFixed(5));
				});
			});
		}
	}

function showAddress(address) {
	var map = new GMap2(document.getElementById("map"));
	map.addControl(new GSmallMapControl());
	map.addControl(new GMapTypeControl());
	if (geocoder) {
		geocoder.getLatLng(
		address,
		function(point) {
			if (!point) {
				alert(address + " not found");
			} else {
				jomresJquery('#lat').val(point.lat().toFixed(5));
				jomresJquery('#lng').val( point.lng().toFixed(5));
				map.clearOverlays()
				map.setCenter(point, 14);
				var marker = new GMarker(point, {draggable: true});  
				map.addOverlay(marker);
				GEvent.addListener(marker, "dragend", function() {
					var pt = marker.getPoint();
					map.panTo(pt);
					jomresJquery('#lat').val(pt.lat().toFixed(5));
					jomresJquery('#lng').val(pt.lng().toFixed(5));
					});

		GEvent.addListener(map, "moveend", function() {
			map.clearOverlays();
			var center = map.getCenter();
			var marker = new GMarker(center, {draggable: true});
			map.addOverlay(marker);
			jomresJquery('#lat').val(center.lat().toFixed(5));
			jomresJquery('#lng').val(center.lng().toFixed(5));

			GEvent.addListener(marker, "dragend", function() {
				var pt = marker.getPoint();
				map.panTo(pt);
				jomresJquery('#lat').val(pt.lat().toFixed(5));
				jomresJquery('#lng').val(pt.lng().toFixed(5));
				});
			});
		}
		});
	}
}

jomresJquery(document).ready(function() {
	load()
	});
</script>

<form action="{JOMRES_SITEPAGE_URL}" method="post" name="regForm">
<input type="button" name="send2" value="Submit" class="button" onclick="validatePropertyRegistration();"/>
<table class="jradmin_table">
	<tr>
		<td class="jradmin_field_ca">{JOMRES_REGISTRATION_INSTRUCTIONS_STEP2_1}<br />{JOMRES_REGISTRATION_INSTRUCTIONS_STEP2_2}</td>
	</tr>
	<tr>
		<td>
		<br />
			<table class="jradmin_table">
				<tr>
					<td class="jradmin_subheader_la">{HPROPERTY_TYPE}</td>
					<td colspan="2" class="jradmin_field_la">{PROPERTY_TYPE_DROPDOWN}</td> 
				</tr>
				<tr>
					<td class="jradmin_subheader_la">{HNAME}</td>
					<td class="jradmin_field_la"><input class="inputbox" type="text" size="15" name="property_name" value="{PROPERTY_NAME}" /></td>
					<td class="required">*</td>
				</tr>
				<tr>
					<td class="jradmin_subheader_la">{HSTREET}</td>
					<td class="jradmin_field_la"><input class="inputbox" type="text" size="15" name="property_street" value="{PROPERTY_STREET}" /></td>
					<td class="required">*</td>
				</tr>
				<tr>
					<td class="jradmin_subheader_la">{HTOWN}</td>
					<td class="jradmin_field_la"><input class="inputbox" type="text" size="15" name="property_town" value="{PROPERTY_TOWN}" /></td>
					<td class="required">*</td>
				</tr>
				<tr>
					<td class="jradmin_subheader_la">{HPOSTCODE}</td>
					<td class="jradmin_field_la"><input class="inputbox" type="text" size="10" name="property_postcode" value="{PROPERTY_POSTCODE}" /></td>
					<td class="required">*</td>
				</tr>
				<tr>
					<td class="jradmin_subheader_la">{HTELEPHONE}</td>	
					<td class="jradmin_field_la"><input class="inputbox" type="text" size="15" name="property_tel" value="{PROPERTY_TEL}" /></td>
					<td class="required">*</td>
				</tr>
				<tr>
					<td class="jradmin_subheader_la">{HFAX}</td>
					<td class="jradmin_field_la"><input class="inputbox" type="text" size="15" name="property_fax" value="{PROPERTY_FAX}" /> </td>
					<td class="required"> </td>
				</tr>
				<tr>
					<td class="jradmin_subheader_la">{HEMAIL}</td>
					<td class="jradmin_field_la"><input class="inputbox" type="text" size="40" name="property_email" value="{PROPERTY_EMAIL}" /></td>
					<td class="required">*</td>
				</tr>
				<tr>
					<td class="jradmin_subheader_la">{HPRICE}</td>
					<td colspan="2" class="jradmin_field_la">{CURRENCY}<input class="inputbox" type="text" size="30" name="price" value="{PRICE}" /></td>
				</tr>
				<tr>
					<td colspan="3">{LATLONG_DESC}</td> 
				</tr>
				<tr>
					<td>Lat: (nn.nnnn) <input id="lat"  class="inputbox" type="text" size="30" name="lat" value="{LAT}" /> </td>
					<td>Long: (nn.nnnn) <input id="lng" class="inputbox" type="text" size="30" name="long" value="{LONG}" /> </td>
					<td></td>
				</tr>
				<tr>
					<td colspan="3"> <div align="center" id="map" style="width: 600px; height: 400px"><br/></div> </td>
				</tr>
				<tr>
					<td class="jradmin_subheader_la">{HFEATURES}</td>
					<td colspan="2" class="jradmin_field_la">{FEATURES}</td>
				</tr>
				<tr>
					<td colspan="3" class="jradmin_field_la">
						<patTemplate:tmpl name="globalPfeatures">
						<div style="float:left;">
						<input type="checkbox" name="pid[]" value="{PID}" style="float:left;" > {FEATURE}
						</div>
						</patTemplate:tmpl>
					</td>
				</tr>
				<tr>
					<td class="jradmin_subheader_la">{HPROPDESCRIPTION}</td>
					<td class="jradmin_field_la"><textarea class="inputbox" cols="40" rows="3" name="property_description">{PROPERTY_DESCRIPTION}</textarea></td>
					<td class="required">*</td>
				</tr>
				<!-- <tr>
					<td class="jradmin_subheader_la">{HCHECKINTIMES}</td>
					<td colspan="2" class="jradmin_field_la"><textarea class="inputbox" cols="40" rows="3" name="property_checkin_times">{PROPERTY_CHECKIN_TIMES}</textarea></td>
				</tr>
				<tr>
					<td class="jradmin_subheader_la">{HAREAACTIVITIES}</td>
					<td colspan="2" class="jradmin_field_la"><textarea class="inputbox" cols="40" rows="3" name="property_area_activities">{PROPERTY_AREA_ACTIVITIES}</textarea></td>
				</tr>
				<tr>
					<td class="jradmin_subheader_la">{HDRIVINGDIRECTIONS}</td>
					<td colspan="2" class="jradmin_field_la"><textarea class="inputbox" cols="40" rows="3" name="property_driving_directions">{PROPERTY_DRIVING_DIRECTIONS}</textarea></td>
				</tr>
				<tr>
					<td class="jradmin_subheader_la">{HAIRPORTS}</td>
					<td colspan="2" class="jradmin_field_la"><textarea class="inputbox" cols="40" rows="3" name="property_airports">{PROPERTY_AIRPORTS}</textarea></td>
				</tr>
				<tr>
					<td class="jradmin_subheader_la">{HOTHERTRANSPORT}</td>
					<td colspan="2" class="jradmin_field_la"><textarea class="inputbox" cols="40" rows="3" name="property_othertransport">{PROPERTY_OTHERTRANSPORT}</textarea></td>
				</tr>
				<tr>
					<td class="jradmin_subheader_la">{HPOLICIESDISCLAIMERS}</td>
					<td colspan="2" class="jradmin_field_la"><textarea class="inputbox" cols="40" rows="3" name="property_policies_disclaimers">{PROPERTY_POLICIES_DISCLAIMERS}</textarea></td>
				</tr> -->
			</table>
		</td>
	</tr>
</table>
<input type="hidden" name="propertyType" value="{PROPERTYTYPE}" />
<input type="hidden" name="property_region" value="{PROPERTY_REGION}" />
<input type="hidden" name="property_country" value="{PROPERTY_COUNTRY}" />
<input type="hidden" name="realestate" value="1" />
<input type="button" name="send" value="Submit" class="button" onclick="validatePropertyRegistration();"/>
<input type="hidden" name="no_html" value="1" />
</form>
</patTemplate:tmpl>
