<patTemplate:tmpl name="pageoutput">
<script src="http://maps.google.com/maps?file=api&v=2.x&key={APIKEY}&hl=en" type="text/javascript"></script>
<script language="javascript">
<!--
function OnChange(dropdown)
	{	
	var myindex	= dropdown.selectedIndex
	var baseURL= "{JOMRES_SITEPAGE_URL}&task=editProperty"
	top.location.href = baseURL + "&propertyUid={PROPERTYUID}&selectedCountry="+dropdown.options[myindex].value;
	return true;
	}
//-->
</script>
<script language="javascript">
<!--
function OnChange(dropdown)
	{	
	var myindex	= dropdown.selectedIndex
	var baseURL= "{JOMRES_SITEPAGE_URL}&task=editProperty"
	top.location.href = baseURL + "&propertyUid={PROPERTYUID}&selectedCountry="+dropdown.options[myindex].value;
	return true;
	}
//-->
<!-- Clickable locations adapted from http://universimmedia.pagesperso-orange.fr/geo/loc.htm -->
function load() {
	if (GBrowserIsCompatible()) {
		var map = new GMap2(document.getElementById("map"));
		map.setUIToDefault();
		map.setMapType(G_HYBRID_MAP);
		map.enableScrollWheelZoom();
		var center = new GLatLng({LAT},{LONG});
		map.setCenter(center, 15);
		geocoder = new GClientGeocoder();
		var marker = new GMarker(center, {draggable: true});  
		map.addOverlay(marker);
		document.getElementById("lat").innerHTML = center.lat().toFixed(5);
		document.getElementById("lng").innerHTML = center.lng().toFixed(5);

		GEvent.addListener(marker, "dragend", function() {
			var point = marker.getPoint();
			map.panTo(point);
			jomresJquery('#lat').val(point.lat().toFixed(5));
			jomresJquery('#lng').val(point.lng().toFixed(5));
			});

		GEvent.addListener(map, "moveend", function() {
			map.clearOverlays();
			var center = map.getCenter();
			var marker = new GMarker(center, {draggable: true});
			map.addOverlay(marker);
			jomresJquery('#lat').val( center.lat().toFixed(5) );
			jomresJquery('#lng').val( center.lng().toFixed(5) );

			GEvent.addListener(marker, "dragend", function() {
				var point =marker.getPoint();
				map.panTo(point);
				jomresJquery('#lat').val(point.lat().toFixed(5));
				jomresJquery('#lng').val( point.lng().toFixed(5));
				});
			});
		}
	}

function showAddress(address) {
	var map = new GMap2(document.getElementById("map"));
	map.addControl(new GSmallMapControl());
	map.addControl(new GMapTypeControl());
	if (geocoder) {
		geocoder.getLatLng(
		address,
		function(point) {
			if (!point) {
				alert(address + " not found");
			} else {
				jomresJquery('#lat').val(point.lat().toFixed(5));
				jomresJquery('#lng').val( point.lng().toFixed(5));
				map.clearOverlays()
				map.setCenter(point, 14);
				var marker = new GMarker(point, {draggable: true});  
				map.addOverlay(marker);
				GEvent.addListener(marker, "dragend", function() {
					var pt = marker.getPoint();
					map.panTo(pt);
					jomresJquery('#lat').val(pt.lat().toFixed(5));
					jomresJquery('#lng').val(pt.lng().toFixed(5));
					});

		GEvent.addListener(map, "moveend", function() {
			map.clearOverlays();
			var center = map.getCenter();
			var marker = new GMarker(center, {draggable: true});
			map.addOverlay(marker);
			jomresJquery('#lat').val(center.lat().toFixed(5));
			jomresJquery('#lng').val(center.lng().toFixed(5));

			GEvent.addListener(marker, "dragend", function() {
				var pt = marker.getPoint();
				map.panTo(pt);
				jomresJquery('#lat').val(pt.lat().toFixed(5));
				jomresJquery('#lng').val(pt.lng().toFixed(5));
				});
			});
		}
		});
	}
}

jomresJquery(document).ready(function() {
	load()
	});

</script>
<form action="{JOMRES_SITEPAGE_URL}" method="post" name="adminForm">
<div class="ui-widget ui-widget-content ui-corner-all"  style="margin-bottom: 10px;">
<table width="100%">
	<tr>
		<th><div class="fg-toolbar ui-widget-header ui-corner-all">{PAGETITLE}</div></th>
	</tr>
	<tr>
		<td>{JOMRESTOOLBAR}</td>
	</tr>
	<tr>
		<td>{DELETEWARNING}</td>
	</tr>
	<tr>
		<td>
			<table>
				<tr>
					<td class="jomres_message">{CHANGECOUNTRYWARNING}<br /></td>
				</tr>
			</table>
			<table>
				<tr>
					<td class="ui-widget-header ui-corner-all">{HCOUNTRY}</td>
					<td >{COUNTRIESDROPDOWN}</td>
				</tr>
				<tr>
					<td class="ui-widget-header ui-corner-all">{HREGION}</td>
					<td >{REGIONDROPDOWN}</td>
				</tr>
				<tr>
					<td colspan="2">&nbsp;</td> 
				</tr>
				<tr>
					<td class="ui-widget-header ui-corner-all">{HPROPERTY_TYPE}</td>
					<td >{PROPERTY_TYPE_DROPDOWN}</td>
				<tr>
					<td colspan="2">&nbsp;</td> 
				</tr>
					<td class="ui-widget-header ui-corner-all">{HNAME}</td>
					<td ><input class="inputbox" type="text" size="30" name="property_name" value="{PROPERTY_NAME}" /> </td> 
				</tr>
				<tr>
					<td class="ui-widget-header ui-corner-all">{HSTREET}</td>
					<td ><input class="inputbox" type="text" size="30" name="property_street" value="{PROPERTY_STREET}" /> </td>
				</tr>
				<tr>
					<td class="ui-widget-header ui-corner-all">{HTOWN}</td>
					<td ><input class="inputbox" type="text" size="30" name="property_town" value="{PROPERTY_TOWN}" /> </td>
				</tr>
				<tr>
					<td class="ui-widget-header ui-corner-all">{HPOSTCODE}</td>
					<td ><input class="inputbox" type="text" size="30" name="property_postcode" value="{PROPERTY_POSTCODE}" /> </td>	
				</tr>
				<tr>
					<td class="ui-widget-header ui-corner-all">{HTELEPHONE}</td>	
					<td ><input class="inputbox" type="text" size="30" name="property_tel" value="{PROPERTY_TEL}" /> </td>
				</tr>
				<tr>
					<td class="ui-widget-header ui-corner-all">{HFAX}</td>
					<td ><input class="inputbox" type="text" size="30" name="property_fax" value="{PROPERTY_FAX}" /> </td>
				</tr>
				<tr>
					<td class="ui-widget-header ui-corner-all">{HEMAIL}</td>
					<td ><input class="inputbox" type="text" size="30" name="property_email" value="{PROPERTY_EMAIL}" /></td>
				</tr>
				<tr>
					<td colspan="2">&nbsp;</td> 
				</tr>
				<tr>
					<td class="ui-widget-header ui-corner-all">{HPRICE}</td>
					<td >{CURRENCY}<input class="inputbox" type="text" size="30" name="price" value="{PRICE}" /></td>
				</tr>
				<tr>
					<td colspan="2">&nbsp;</td> 
				</tr>
				<tr>
					<td colspan="2">{LATLONG_DESC}</td> 
				</tr>
				<tr>
					<td>Lat: (nn.nnnn) <input id="lat"  class="inputbox" type="text" size="30" name="lat" value="{LAT}" /> </td>
					<td >Long: (nn.nnnn) <input id="lng" class="inputbox" type="text" size="30" name="long" value="{LONG}" /> </td>
				</tr>
				<tr>
					<td colspan="2"> <div align="center" id="map" style="width: 600px; height: 400px"><br/></div> </td>
				</tr>
			</table>
			<br />
			<table width="100%">
				<tr>
					<td class="fg-toolbar ui-widget-header ui-corner-all">{HFEATURES}</td>
				</tr>
				<tr>
					<td>
						<table>
							<tr>
								<td >
									<patTemplate:tmpl name="globalPfeatures">
										<div style="float:left;margin:2px;border:1px solid #d1d1d1;">
											{FEATURE}<input type="checkbox" name="pid[]" value="{PID}" style="float:left;padding:0;margin:2px 2px 0 0;" {ISCHECKED}>
										</div>
									</patTemplate:tmpl>
								</td>
							</tr>
						</table>
						<br />
						<table class="jradmin_table">
							<tr>
								<td class="fg-toolbar ui-widget-header ui-corner-all">{HPROPDESCRIPTION}</td>
							</tr>
							<tr>
								<td>{PROPERTY_DESCRIPTION}</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</td>
	</tr>
</table>
{JOMRESTOKEN}
<input type="hidden" name="property_uid" value="{PROPERTYUID}" />
<input type="hidden" name="task" value="saveProperty" />
{TOOLBAR2}
</div>
</form>

<br />

<form enctype="multipart/form-data" action="{JOMRES_SITEPAGE_URL}&task=uploadPropertyImage" method="post">
<table class="jradmin_innerwrapper">
	<tr>
		<td>
			<table class="jradmin_table">
				<tr>
					<td colspan="2" class="fg-toolbar ui-widget-header ui-corner-all">{UPLOADIMAGE}</td>
				</tr>
				<tr>
					<td colspan="2" class="jomres_message">{SAVEBEFOREUPLOADWARNING}</td>
				</tr>
				<tr>
					<td><input type='file' name='image'/></td>
					<td><input type="submit" value="{UPLOADIMAGE}" class="button" /></td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td>
			<table class="jradmin_table">
				<tr>
					<td>{DELETEIMAGE}</td>
					<td>{IMAGE}</td>
				</tr>
			</table>
		</td>
	</tr>
</table>
{JOMRESTOKEN}
</form>
</patTemplate:tmpl>
